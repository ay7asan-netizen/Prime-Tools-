<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Prime Tools â€” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</title>
  <style>
    body{margin:0;background:#0e0e10;color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,Tajawal,sans-serif}
    .wrap{max-width:420px;margin:40px auto;padding:0 16px}
    .card{background:#141418;border:1px solid #27272a;border-radius:14px;padding:16px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
    h1{margin:0 0 14px}
    .field{position:relative;margin-top:10px}
    input{width:100%;padding:12px 44px 12px 12px;border-radius:10px;border:1px solid #303036;background:#0f0f12;color:#fff}
    .eye{position:absolute;left:10px;top:50%;transform:translateY(-50%);cursor:pointer;user-select:none;opacity:.8}
    .row{display:flex;align-items:center;justify-content:space-between;margin-top:10px}
    .btn{width:100%;padding:12px;border:none;border-radius:10px;background:#27b0ff;color:#061019;font-weight:800;cursor:pointer;margin-top:12px}
    .muted{color:#a6a6b0;font-size:14px;margin-top:10px}
    a{color:#9cd2ff;text-decoration:none}
    .top{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
    .link{color:#9cd2ff;text-decoration:none;font-size:14px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="top">
        <h1>Prime Tools</h1>
        <a class="link" href="admin.html">Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†</a>
      </div>

      <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
      <div class="field">
        <input id="email" type="email" placeholder="example@mail.com" autocomplete="username" />
      </div>

      <label style="margin-top:10px">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
      <div class="field">
        <input id="password" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="current-password" />
        <span id="toggle" class="eye">ğŸ‘ï¸</span>
      </div>

      <div class="row">
        <label style="display:flex;gap:8px;align-items:center">
          <input id="remember" type="checkbox" /> ØªØ°ÙƒÙ‘Ø±Ù†ÙŠ
        </label>
        <span class="muted">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ù‡Ù†Ø§ â€” ÙÙ‚Ø· Ù…Ù† Ø§Ù„Ø£Ø¯Ù…Ù†</span>
      </div>

      <button class="btn" id="loginBtn">Ø¯Ø®ÙˆÙ„</button>
      <div id="msg" class="muted"></div>
    </div>
  </div>

  <!-- Firebase (Compat) -->
  <script src="https://www.gstatic.com/firebasejs/12.5.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/12.5.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/12.5.0/firebase-firestore-compat.js"></script>

  <script>
    // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù…Ø´Ø±ÙˆØ¹Ùƒ
    const firebaseConfig = {
      apiKey: "AIzaSyCEbKMZHqJQ-UU6Qco7FlAue0E4mCWd4UY",
      authDomain: "prime-tools99.firebaseapp.com",
      projectId: "prime-tools99",
      storageBucket: "prime-tools99.firebasestorage.app",
      messagingSenderId: "112360376529",
      appId: "1:112360376529:web:f5fac1d99a87f7f5a85df0"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db   = firebase.firestore();

    // Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
    document.getElementById('toggle').onclick = ()=>{
      const p = document.getElementById('password');
      p.type = (p.type === 'password') ? 'text' : 'password';
    };

    // ØªØ°ÙƒÙ‘Ø±Ù†ÙŠ = LOCAL | Ø¨Ø¯ÙˆÙ† ØªØ°ÙƒÙ‘Ø± = SESSION
    async function setPersistence(remember){
      const kind = remember ? firebase.auth.Auth.Persistence.LOCAL
                            : firebase.auth.Auth.Persistence.SESSION;
      await auth.setPersistence(kind);
    }

    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    document.getElementById('loginBtn').onclick = async ()=>{
      const email = document.getElementById('email').value.trim();
      const pass  = document.getElementById('password').value;
      const remember = document.getElementById('remember').checked;
      const msg = document.getElementById('msg');
      msg.textContent = '';
      try{
        await setPersistence(remember);
        const cred = await auth.signInWithEmailAndPassword(email, pass);
        // ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ø­Ø³Ø§Ø¨ Ù…ÙØ¹Ù‘Ù„
        const udoc = await db.collection('users').doc(cred.user.uid).get();
        if(!udoc.exists) { msg.textContent = 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù„Ù Ù…Ø³ØªØ®Ø¯Ù….'; await auth.signOut(); return; }
        const u = udoc.data();
        if(u.status !== 'approved'){ msg.textContent = 'Ø­Ø³Ø§Ø¨Ùƒ ØºÙŠØ± Ù…ÙØ¹Ù‘Ù„.'; await auth.signOut(); return; }
        // Ù†Ø¬Ø§Ø­
        window.location.href = 'user.html';
      }catch(e){
        msg.textContent = 'Ø®Ø·Ø£: ' + e.message;
      }
    };
  </script>
</body>
</html>
